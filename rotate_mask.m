function rotated_mask = rotate_mask(M, rot)
    
    rotated_mask = zeros(3, 3, 3);
    switch rot
        
        % US rotation.
        case 1
            rotated_mask = M;
            
        % NE rotation.
        case 2
            rotated_mask(:, :, 1) = ...
                [M(1,3,3) M(2,3,3) M(3,3,3)
                 M(1,3,2) M(2,3,2) M(3,3,2)
                 M(1,3,1) M(2,3,1) M(3,3,1)];
             rotated_mask(:, :, 2) = ...
                [M(1,2,3) M(2,2,3) M(3,2,3)
                 M(1,2,2) M(2,2,2) M(3,2,2)
                 M(1,2,1) M(2,2,1) M(3,2,1)];
             rotated_mask(:, :, 3) = ...
                [M(1,1,3) M(2,1,3) M(3,1,3)
                 M(1,1,2) M(2,1,2) M(3,1,2)
                 M(1,1,1) M(2,1,1) M(3,1,1)];
            
        % WD rotation.
        case 3
            rotated_mask(:, :, 1) = ...
                [M(3,1,3) M(3,1,2) M(3,1,1)
                 M(3,2,3) M(3,2,2) M(3,2,1)
                 M(3,3,3) M(3,3,2) M(3,3,1)];
             rotated_mask(:, :, 2) = ...
                [M(2,1,3) M(2,1,2) M(2,1,1)
                 M(2,2,3) M(2,2,2) M(2,2,1)
                 M(2,3,3) M(2,3,2) M(2,3,1)];
             rotated_mask(:, :, 3) = ...
                [M(1,1,3) M(1,1,2) M(1,1,1)
                 M(1,2,3) M(1,2,2) M(1,2,1)
                 M(1,3,3) M(1,3,2) M(1,3,1)];
            
        % ES rotation.
        case 4
            rotated_mask(:, :, 1) = ...
                [M(1,3,1) M(2,3,1) M(3,3,1)
                 M(1,2,1) M(2,2,1) M(3,2,1)
                 M(1,1,1) M(2,1,1) M(3,1,1)];
             rotated_mask(:, :, 2) = ...
                [M(1,3,2) M(2,3,2) M(3,3,2)
                 M(1,2,2) M(2,2,2) M(3,2,2)
                 M(1,1,2) M(2,1,2) M(3,1,2)];
             rotated_mask(:, :, 3) = ...
                [M(1,3,3) M(2,3,3) M(3,3,3)
                 M(1,2,3) M(2,2,3) M(3,2,3)
                 M(1,1,3) M(2,1,3) M(3,1,3)];
            
        % UW rotation.
        case 5
            rotated_mask(:, :, 1) = ...
                [M(1,1,3) M(1,1,2) M(1,1,1)
                 M(2,1,3) M(2,1,2) M(2,1,1)
                 M(3,1,3) M(3,1,2) M(3,1,1)];
             rotated_mask(:, :, 2) = ...
                [M(1,2,3) M(1,2,2) M(1,2,1)
                 M(2,2,3) M(2,2,2) M(2,2,1)
                 M(3,2,3) M(3,2,2) M(3,2,1)];
             rotated_mask(:, :, 3) = ...
                [M(1,3,3) M(1,3,2) M(1,3,1)
                 M(2,3,3) M(2,3,2) M(2,3,1)
                 M(3,3,3) M(3,3,2) M(3,3,1)];
        
        % ND rotation.
        case 6
            rotated_mask(:, :, 1) = ...
                [M(3,3,3) M(3,2,3) M(3,1,3)
                 M(3,3,2) M(3,2,2) M(3,1,2)
                 M(3,3,1) M(3,2,1) M(3,1,1)];
             rotated_mask(:, :, 2) = ...
                [M(2,3,3) M(2,2,3) M(2,1,3)
                 M(2,3,2) M(2,2,2) M(2,1,2)
                 M(2,3,1) M(2,2,1) M(2,1,1)];
             rotated_mask(:, :, 3) = ...
                [M(1,3,3) M(1,2,3) M(1,1,3)
                 M(1,3,2) M(1,2,2) M(1,1,2)
                 M(1,3,1) M(1,2,1) M(1,1,1)];
            
        % SW rotation.
        case 7
            rotated_mask(:, :, 1) = ...
                [M(1,1,1) M(2,1,1) M(3,1,1)
                 M(1,1,2) M(2,1,2) M(3,1,2)
                 M(1,1,3) M(2,1,3) M(3,1,3)];
             rotated_mask(:, :, 2) = ...
                [M(1,2,1) M(2,2,1) M(3,2,1)
                 M(1,2,2) M(2,2,2) M(3,2,2)
                 M(1,2,3) M(2,2,3) M(3,2,3)];
             rotated_mask(:, :, 3) = ...
                [M(1,3,1) M(2,3,1) M(3,3,1)
                 M(1,3,2) M(2,3,2) M(3,3,2)
                 M(1,3,3) M(2,3,3) M(3,3,3)];
            
        % UN rotation.
        case 8
            rotated_mask(:, :, 1) = ...
                [M(1,3,3) M(1,2,3) M(1,1,3)
                 M(2,3,3) M(2,2,3) M(2,1,3)
                 M(3,3,3) M(3,2,3) M(3,1,3)];
             rotated_mask(:, :, 2) = ...
                [M(1,3,2) M(1,2,2) M(1,1,2)
                 M(2,3,2) M(2,2,2) M(2,1,2)
                 M(3,3,2) M(3,2,2) M(3,1,2)];
             rotated_mask(:, :, 3) = ...
                [M(1,3,1) M(1,2,1) M(1,1,1)
                 M(2,3,1) M(2,2,1) M(2,1,1)
                 M(3,3,1) M(3,2,1) M(3,1,1)];
            
        % ED rotation.
        case 9
            rotated_mask(:, :, 1) = ...
                [M(3,3,1) M(3,3,2) M(3,3,3)
                 M(3,2,1) M(3,2,2) M(3,2,3)
                 M(3,1,1) M(3,1,2) M(3,1,3)];
             rotated_mask(:, :, 2) = ...
                [M(2,3,1) M(2,3,2) M(2,3,3)
                 M(2,2,1) M(2,2,2) M(2,2,3)
                 M(2,1,1) M(2,1,2) M(2,1,3)];
             rotated_mask(:, :, 3) = ...
                [M(1,3,1) M(1,3,2) M(1,3,3)
                 M(1,2,1) M(1,2,2) M(1,2,3)
                 M(1,1,1) M(1,1,2) M(1,1,3)];
        
        % NW rotation.
        case 10
            rotated_mask(:, :, 1) = ...
                [M(3,1,3) M(2,1,3) M(1,1,3)
                 M(3,1,2) M(2,1,2) M(1,1,2)
                 M(3,1,1) M(2,1,1) M(1,1,1)];
             rotated_mask(:, :, 2) = ...
                [M(3,2,3) M(2,2,3) M(1,2,3)
                 M(3,2,2) M(2,2,2) M(1,2,2)
                 M(3,2,1) M(2,2,1) M(1,2,1)];
             rotated_mask(:, :, 3) = ...
                [M(3,3,3) M(2,3,3) M(1,3,3)
                 M(3,3,2) M(2,3,2) M(1,3,2)
                 M(3,3,1) M(2,3,1) M(1,3,1)];
            
        % UE rotation.
        case 11
            rotated_mask(:, :, 1) = ...
                [M(1,3,1) M(1,3,2) M(1,3,3)
                 M(2,3,1) M(2,3,2) M(2,3,3)
                 M(3,3,1) M(3,3,2) M(3,3,3)];
             rotated_mask(:, :, 2) = ...
                [M(1,2,1) M(1,2,2) M(1,2,3)
                 M(2,2,1) M(2,2,2) M(2,2,3)
                 M(3,2,1) M(3,2,2) M(3,2,3)];
             rotated_mask(:, :, 3) = ...
                [M(1,1,1) M(1,1,2) M(1,1,3)
                 M(2,1,1) M(2,1,2) M(2,1,3)
                 M(3,1,1) M(3,1,2) M(3,1,3)];
        
        % SD rotation.
        case 12
            rotated_mask(:, :, 1) = ...
                [M(3,1,1) M(3,2,1) M(3,3,1)
                 M(3,1,2) M(3,2,2) M(3,3,2)
                 M(3,1,3) M(3,2,3) M(3,3,3)];
             rotated_mask(:, :, 2) = ...
                [M(2,1,1) M(2,2,1) M(2,3,1)
                 M(2,1,2) M(2,2,2) M(2,3,2)
                 M(2,1,3) M(2,2,3) M(2,3,3)];
             rotated_mask(:, :, 3) = ...
                [M(1,1,1) M(1,2,1) M(1,3,1)
                 M(1,1,2) M(1,2,2) M(1,3,2)
                 M(1,1,3) M(1,2,3) M(1,3,3)];
    end
end

